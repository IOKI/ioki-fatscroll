angular.module("ioki.fatscroll",[]).directive("fatscroll",["$document","fatscrollsService",function(a,b){"use strict";return{restrict:"A",transclude:!0,templateUrl:"templates/ioki-fatscroll",scope:{},link:function(c,d,e){function f(){g(),o=d[0],p=d[0].clientHeight,q=o.firstChild,r=d.find("scroll-area"),s=d.find("scroll-content")[0].clientHeight,x=p/s,B=a.find("body"),j(),r.css("height",p+"px"),p>=s?A.css("display","none"):A.css("display","block")}function g(){var a=e.fatscrollName;void 0!==a&&b.addFatscroll(a,c)}function h(a,b){var c=k();z=parseInt(c/x,10),a=parseInt(a,10),"number"!=typeof a&&(a="number"==typeof b?a.offsetTop+b:a.offsetTop),a>z?(A.css("top",c+"px"),C=c,q.scrollTop=z):0>a?(A.css("top","0"),C=0,q.scrollTop=0):(A.css("top",+(a*x)+"px"),C=a*x,q.scrollTop=a)}function i(a){var b=void 0!==a.deltaY?a.deltaY:40*a.detail;q.scrollTop+=b,h(q.scrollTop)}function j(){var a=x*p;return A.css({height:a+"px"}),a}function k(){return t=j(),p-t}function l(b){v=b.y||b.clientY,u=parseInt(A.css("top")||0,10),w=q.scrollTop,a.on("mousemove",n),a.on("mouseup",m)}function m(){a.off("mousemove",n),B.removeClass("no-select")}function n(a){y=u+a.pageY-v,t=j(),B.addClass("no-select"),h(w+(a.pageY-v)/x)}var o,p,q,r,s,t,u,v,w,x,y,z,A=d.find("thumb"),B=a.find("body"),C=0;c.scrollContentHeight=d.find("scroll-content")[0],d.on("mousewheel",i),d.on("DOMMouseScroll",i),A.on("mousedown touchstart",l),f(),c.$watch("scrollContentHeight.clientHeight",function(a,b){a!==b&&f()}),c.scrollTo=h}}}]),angular.module("ioki.fatscroll").factory("fatscrollsService",function(){"use strict";var a={fatscrolls:[],getFatscrolls:function(){return a.fatscrolls},getFatscroll:function(b){for(var c=0,d=a.fatscrolls.length;d>c;c++)if(a.fatscrolls[c].name===b)return a.fatscrolls[c].scope;return null},addFatscroll:function(b,c){void 0!==b&&void 0!==c&&a.fatscrolls.push({name:b,scope:c})},moveMeTo:function(b,c,d){var e=a.getFatscroll(b);null!==e&&e.scrollTo(c,d)}};return a}),angular.module("ioki.fatscroll").run(["$templateCache",function(a){"use strict";a.put("templates/ioki-fatscroll",'<scroll-area>\n    <scroll-content class="scroll-content" ng-transclude></scroll-content>\n</scroll-area>\n<thumb></thumb>')}]);